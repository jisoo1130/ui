<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title></title>
  <link rel="stylesheet" href="./common/css/reset.css">
  <link rel="stylesheet" href="./common/css/style.css">
  <script src="./common/js/jquery-2.2.4.min.js"></script>
  <script src="./common/js/jquery-ui.min.js"></script>
  <script src="./common/js/index.js"></script>
  <!-- <script id="snowAnimate">
    var flakeCnt; var delta_x = new Array(), delta_y = new Array(); var move_x = new Array(), move_y = new Array(); var resolution_x, resolution_y; $(function () { resolution_x = document.documentElement.clientWidth, resolution_y = document.documentElement.clientHeight; var position_x, position_y, i = 0; flakeCnt = document.getElementById('petalCanvas').getElementsByTagName('span').length; $("#petalCanvas span").each(function () { position_x = Math.random() * resolution_x; position_y = -30 - (Math.random() * 100); $(this).css({ "left": position_x + "px", "top": position_y + "px" }); $(this).attr("id", "drop" + i); move_x[i] = position_x; move_y[i] = position_y; i++; }); petalSet(); }); function petalSet() { var hei, speed; if (resolution_y < 1000) { hei = 1000; } else { hei = resolution_y; } var max_angle = hei / 2; for (var i = 0; i < flakeCnt; i++) { speed = Math.random(); delta_x[i] = (speed * max_angle) / 1200 + i / 100; delta_y[i] = (speed * 0.4) + 0.3; } petalDrop(); } function petalDrop() { for (var i = 0; i < flakeCnt; i++) { move_x[i] -= delta_x[i]; move_y[i] += delta_y[i]; if (move_x[i] < 0) move_x[i] = resolution_x - 30; if (move_y[i] > resolution_y - 10) move_y[i] = -20; $("#drop" + i).css({ "left": move_x[i] + "px", "top": move_y[i] + "px" }); } setTimeout("petalDrop()", 5); }
  </script> -->
  <script>

    // 스크롤 방지
    $('html, body').css({'overflow': 'hidden', 'height': '100%'});
    $('#element').on('scroll touchmove mousewheel', function(event) {
      event.preventDefault();
      event.stopPropagation();
      return false;
    });



    $(document).ready(function () {

      // 초기화
      let windowH = $(window).height();
      let $screen = $('html, body');
      let $step = $('.story > .step');
      let $nextBtn = $('.next_btn');
      let $snow = $('#petalCanvas');
      let screenIdx = 0;
      let ingBln = false;

      $step.height(windowH);

      $nextBtn.on('click', function () {
        screenIdx++;

        if (screenIdx === 1) {
          step01();
        } else if (screenIdx === 2) {
          step02();
        } else if (screenIdx === 3) {
          step03();
        } else if (screenIdx === 4) {
          step04();
        } else if (screenIdx === 5) {
          step05();
        }
      });

      init();

      function init() {
        disableBtn(true);
        typing('빛나\n연대기\nfeat.성주', $('.step').eq(0));
      }

      function step01() {
        disableBtn(true);
        $step.addClass('on');
        // $snow.animate({
        //   opacity: 0
        // }, 1000);

        move(windowH, 1000);

        setTimeout(function () {
          $step.eq(1).find('.binna').animate({
            opacity: 1
          }, 1000, function () {
            typing('1992년 6월 9일 서울에 예쁜 아기가 태어났어요. 이름은 빛나였어요. 빛나는 세상 어느 아기보다 밝게 빛나고 사랑스러운 아기였어요..♥', $('.step').eq(1));
          });
        }, 1000);
      }

      function step02() {
        disableBtn(true);
        $step.addClass('on');
        let positionH = $step.eq(2).offset().top;
        move(positionH, 1000);

        setTimeout(function () {
          $step.eq(2).find('.binna').animate({
            opacity: 1
          }, 1000, function () {
            typing('빛나는 어느덧 대학생이 되어 수원역 푸드코트에서 아르바이트를 하게 되었어요. 그러던 중 주방에서 나시고랭을 볶던 한 남자를 발견했어요. 그 남자의 이름은 성주였고 그렇게 둘의 첫 만남이 시작되었어요.', $('.step').eq(2));
          });
        }, 1000);

        setTimeout(function () {
          $step.eq(2).find('.seongju').animate({
            opacity: 1
          }, 1000);
        }, 5000);
      }

      function step03() {
        disableBtn(true);
        $step.addClass('on');
        let positionH = $step.eq(3).offset().top;
        move(positionH, 1000);

        setTimeout(function () {
          $step.eq(3).find('.binna').animate({
            opacity: 1
          }, 1000, function () {
            typing('빛나와 성주는 처음 만났을 때부터 서로에게 호감이 있었어요. 그래서 연락을 간간이 주고받다가 대학교 때 만남을 가지게 되었어요. 하지만 이때는 몰랐어요.. 서로 좋아하는 마음만 있으면 이쁘게 만날 줄 알았어요.. 서로 어렸던 걸까요..? 서툴렀었던 걸까요..? 서로에게 아쉬움만 남긴채 한달간의 짧은 만남은 끝이 났어요..', $('.step').eq(3));
          });
        }, 1000);

        setTimeout(function () {
          $step.eq(3).find('.seongju').animate({
            opacity: 1
          }, 1000);
        }, 1000);
      }

      function step04() {
        disableBtn(true);
        $step.addClass('on');
        let positionH = $step.eq(4).offset().top;
        move(positionH, 1000);

        setTimeout(function () {
          typing('그로 부터 몇년이 흘렀을까요..? 세상은 많이 변해있었어요. 빛나와 성주는 어느새 직장인이 되어 바쁜 하루하루를 살아가고 있었어요. 우연이였을까요..? 빛나와 성주의 회사가 가깝다는 것을 서로 알게 되었어요. 빛나와 성주는 강남에서 만나게 되었어요.', $('.step').eq(4));
        }, 1000);
      }

      function step05() {
        disableBtn(true);
        $step.addClass('on');
        let positionH = $step.eq(5).offset().top;
        move(positionH, 1000);

        setTimeout(function () {
          $step.eq(5).find('.binna').animate({
            opacity: 1
          }, 1000, function () {
            typing('ㅇ머매ㅑ너애ㅑ', $('.step').eq(3));
          });
        }, 1000);

        setTimeout(function () {
          $step.eq(5).find('.seongju').animate({
            opacity: 1
          }, 1000);
        }, 1000);
      }


      function move(positionH, spped) {
        $screen.animate({
          scrollTop: positionH
        }, spped, 'easeOutQuint');
      }

      function typing(text, target) {
        let typingBool = false;
        let typingIdx = 0;
        let typingTxt = text;
        let tyInt = null;

        typingTxt = typingTxt.split("");
        if (typingBool == false) {
          typingBool = true;
          tyInt = setInterval(typing, 10);
        }
        target.find('.typing').css('opacity', '1');
        function typing() {
          if (typingIdx < typingTxt.length) {
            target.find('.typing').append(typingTxt[typingIdx]);
            typingIdx++;
          } else {
            clearInterval(tyInt);
            disableBtn(false);
          }
        }
      }

      function disableBtn(bln) {
        $nextBtn.attr("disabled", bln);
      }

    });

  </script>

</head>

<body>

  <div class="story">

    <article class="step">
      <div class="typing"></div>
    </article>

    <article class="step">
      <div class="typing"></div>
      <div class="binna"><img src="./common/images/binna_baby.gif" alt="" /></div>
    </article>

    <article class="step">
      <div class="typing"></div>
      <div class="binna"><img src="./common/images/binna.gif" alt="" /></div>
      <div class="seongju"><img src="./common/images/seongju.gif" alt="" /></div>
    </article>

    <article class="step">
      <div class="typing"></div>
      <div class="binna"><img src="./common/images/binna02.gif" alt="" /></div>
      <div class="seongju"><img src="./common/images/seongju02.gif" alt="" /></div>
    </article>

    <article class="step">
      <div class="typing"></div>
    </article>

    <article class="step">
      <div class="typing"></div>
      <div class="binna"><img src="./common/images/binna03.gif" alt="" /></div>
      <div class="seongju"><img src="./common/images/seongju03.gif" alt="" /></div>
    </article>


    
    

    <button type="button" class="next_btn">GO</button>

  </div>

  <div id="petalCanvas" style="position:fixed;top:0;z-index:999;height:0;overflow:visible;">
    <span>*</span><span>*</span><span>*</span><span>*</span><span>*</span><span>*</span>
    <span>*</span><span>*</span><span>*</span><span>*</span><span>*</span><span>*</span>
    <span>*</span><span>*</span><span>*</span><span>*</span><span>*</span><span>*</span>
    <span>*</span><span>*</span><span>*</span><span>*</span><span>*</span><span>*</span>
    <span>*</span><span>*</span><span>*</span><span>*</span><span>*</span><span>*</span>
    <span>*</span><span>*</span><span>*</span><span>*</span><span>*</span><span>*</span>
  </div>
</body>